@if( activedForm() ) {
    <div class="fixed top-0 left-0 bg-gray-800/50 h-screen w-screen z-60 duration-150 flex
                justify-center items-center"
         (click)="emitCloseForm()"
    >
      <div class="h-1/2 md:h-11/12 w-5/6 md:w-1/2 flex bg-white rounded-3xl shadow-2xl animate-fade-in-right border border-gray-100"
           (click)="$event.stopPropagation()"
      >

        <!-- Contenido  -->
        <div class="px-20 py-10 w-full h-full flex flex-col gap-6 overflow-y-auto">

            <h1 class="text-4xl font-extrabold w-fit mx-auto text-gray-800">
                NUEVO NEGOCIO
            </h1>

            <span class="-mb-3 text-xl font-semibold text-gray-700">
              Imagen del negocio
            </span>

            <!-- Datos del negocio  -->
            <form class="flex flex-col gap-3" [formGroup]="placeRegisterForm">
              <!-- Imagen -->
              <fieldset class="gap-3 w-full relative ">

                @if (imagePreview()) {
                    <div class="object-cover">
                      <img [src]="imagePreview()" class="w-full h-80 object-cover rounded-lg">
                    </div>
                  }@else{
                    <div class="object-cover">
                      <img [src]="imagePreview()" class="w-full h-80 object-cover rounded-lg">
                    </div>
                  }

                  <input type="file"
                        class="absolute top-0 left-0 w-full h-full z-10 cursor-pointer opacity-0"
                        formControlName="image"
                        (change)="onFileSelected($event)"
                  >
                  <span class="absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2
                               font-bold "
                        [ngClass]="{'text-white bg-gray-800/70 w-fit text-center py-2 px-8':uploudedFile()}">
                    Selecciona un archivo
                  </span>
              </fieldset>

              <fieldset class="flex flex-col gap-3 w-full">
                <label for="nombre" class="font-semibold text-gray-700">
                    Nombre del negocio
                </label>

                <input type="text" id="nombre" name="nombre"
                        class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                              outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400"
                        formControlName="name">
              </fieldset>

              <fieldset class="flex flex-col gap-3 w-full">
                <label for="cellphone" class="font-semibold text-gray-700">
                    Telefono
                </label>

                <input type="text" id="cellphone" name="cellphone"
                        class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                              outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400"
                        formControlName="cellphone">
              </fieldset>

              <fieldset class="flex flex-col gap-3 w-full">
                <label for="description" class="font-semibold text-gray-700">
                    Descripción
                </label>

                <textarea id="description" name="description"
                        class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                              outline-0 border border-gray-300 py-2 px-3 font-normal w-full h-32 resize-none align-text-top rounded-lg hover:border-gray-400"
                        formControlName="description"
                ></textarea>
              </fieldset>

              <fieldset class="flex flex-col gap-3 w-full">
                <label for="ubication" class="font-semibold text-gray-700">
                    Ubicación Google Maps
                </label>

                <input type="text" id="urlMaps" name="urlMaps"
                        class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                              outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400"
                        formControlName="urlMaps">
              </fieldset>

              <fieldset class="flex flex-col gap-3 w-full">
                <label for="municipio" class="font-semibold text-gray-700">
                    Municipio
                </label>

                <input type="text" id="municipio" name="municipio"
                        class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                              outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400"
                        formControlName="municipio"
                        (blur)="validateMunicipio()"
                        [ngClass]="{'focus:ring-red-900 border-red-900 border-3 hover:border-red-900': (blurMunicipio() && !correctMunicipio() ) }"
                >
              </fieldset>

            </form>

            <form class="flex flex-col gap-3" [formGroup]="scheduleForm">

              <span class="font-semibold text-gray-700">
                Horarios
              </span>

              <div formArrayName="lunes">
                <fieldset class="flex gap-3 items-center">
                  <label for="lunes">
                    Lunes
                  </label>
                  <input type="text" formControlName="1"
                         class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                         outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400">
                  <span>a</span>
                  <input type="text" formControlName="2"
                         class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                         outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400">

                </fieldset>
              </div>

              <div formArrayName="martes">
                <fieldset class="flex gap-3 items-center">
                  <label for="martes">
                    Martes
                  </label>
                  <input type="text" formControlName="1"
                         class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                         outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400">
                  <span>a</span>
                  <input type="text" formControlName="2"
                         class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                         outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400">

                </fieldset>
              </div>

              <div formArrayName="miercoles">
                <fieldset class="flex gap-3 items-center">
                  <label for="miercoles">
                    Miercoles
                  </label>
                  <input type="text" formControlName="1"
                         class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                         outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400">
                  <span>a</span>
                  <input type="text" formControlName="2"
                         class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                         outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400">

                </fieldset>
              </div>

              <div formArrayName="jueves">
                <fieldset class="flex gap-3 items-center">
                  <label for="jueves">
                    Jueves
                  </label>
                  <input type="text" formControlName="1"
                         class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                         outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400">
                  <span>a</span>
                  <input type="text" formControlName="2"
                         class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                         outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400">

                </fieldset>
              </div>

              <div formArrayName="viernes">
                <fieldset class="flex gap-3 items-center">
                  <label for="viernes">
                    Viernes
                  </label>
                  <input type="text" formControlName="1"
                         class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                         outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400">
                  <span>a</span>
                  <input type="text" formControlName="2"
                         class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                         outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400">

                </fieldset>
              </div>

              <div formArrayName="sabado">
                <fieldset class="flex gap-3 items-center">
                  <label for="sabado">
                    Sabado
                  </label>
                  <input type="text" formControlName="1"
                         class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                         outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400">
                  <span>a</span>
                  <input type="text" formControlName="2"
                         class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                         outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400">

                </fieldset>
              </div>

              <div formArrayName="domingo">
                <fieldset class="flex gap-3 items-center">
                  <label for="domingo">
                    Domingo
                  </label>
                  <input type="text" formControlName="1"
                         class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                         outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400">
                  <span>a</span>
                  <input type="text" formControlName="2"
                         class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                         outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400">

                </fieldset>
              </div>

            </form >

            <form class="flex flex-col gap-3" [formGroup]="urlsForm">
              <fieldset>
                <label for="facebook" class="font-semibold text-gray-700">
                    Link de Facebook
                </label>

                <input type="text" id="facebook" name="facebook"
                        class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                              outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400"
                        formControlName="facebook">
              </fieldset>

              <fieldset>
                <label for="instagram" class="font-semibold text-gray-700">
                    Link de Instagram
                </label>

                <input type="text" id="instagram" name="instagram"
                        class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                              outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400"
                        formControlName="instagram">
              </fieldset>

              <fieldset>
                <label for="sitio_web" class="font-semibold text-gray-700">
                    Link de la página web
                </label>

                <input type="text" id="sitio_web" name="sitio_web"
                        class="focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all ease-out duration-150 shadow-sm
                              outline-0 border border-gray-300 py-2 px-3 font-normal w-full rounded-lg hover:border-gray-400"
                        formControlName="sitio_web">
              </fieldset>


            </form>

            <form [formGroup]="categoryForm"
                  class="flex flex-col gap-3"
            >

              <span class="font-semibold text-gray-700">
                Categorías
              </span>

              <div formArrayName="selectedCategories" class="flex flex-col gap-2">

                @for (category of categories; track category.id; let i = $index) {
                    <div class="flex items-center gap-2">

                      <input
                        type="checkbox"
                        [id]="category.id"
                        [formControlName]="i"
                        [value]="category.nombre"
                        class="size-5 text-green-600 rounded focus:ring-green-500">

                      <label [for]="category.id" class="text-lg text-gray-700 cursor-pointer">
                        {{ category.nombre }}
                      </label>
                    </div>
                }

              </div>

            </form>


            <button class="bg-green-700 text-white py-3 px-8 rounded-lg font-bold text-lg shadow-lg
                           hover:bg-green-800 hover:shadow-xl transition-all duration-200 ease-out cursor-pointer"
                    (click)="onSubmit()">
              Registrar negocio
            </button>

        </div>

      </div>

    </div>
  }
